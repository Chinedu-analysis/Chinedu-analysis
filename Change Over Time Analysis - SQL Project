Query 1: Annual Sales Summary
-- This query aggregates sales data by year, showing:
-- - Total sales amount
-- - Number of distinct customers
-- - Total quantity sold
SELECT
    YEAR(order_date) order_year,
    SUM(sales_amount) AS total_sales,
    COUNT(DISTINCT customer_key) AS total_customers,
    SUM(quantity) AS total_quantity 
FROM gold.fact_sales
WHERE order_date is not null  -- Excludes records with null order dates
GROUP BY YEAR(order_date)
ORDER BY YEAR(order_date)  -- Results ordered chronologically by year


-- Query 2: Monthly Sales Summary
-- This query provides a more granular view than Query 1, breaking down data by month within each year
-- Shows the same metrics as Query 1 but at monthly level
SELECT
    YEAR(order_date) AS order_year,
    MONTH(order_date) AS order_month,
    SUM(sales_amount) AS total_sales,
    COUNT(DISTINCT customer_key) AS total_customers,
    SUM(quantity) AS total_quantity 
FROM gold.fact_sales
WHERE order_date IS NOT NULL  -- Excludes records with null order dates
GROUP BY YEAR(order_date), MONTH(order_date)  -- Groups by both year and month
ORDER BY YEAR(order_date), MONTH(order_date)  -- Ordered chronologically


-- Query 3: Annual Sales Summary using DATETRUNC
-- Alternative version of Query 1 using DATETRUNC function instead of YEAR()
-- DATETRUNC truncates the date to the specified precision (year in this case)
SELECT
    DATETRUNC(year, order_date) AS order_date,
    SUM(sales_amount) AS total_sales,
    COUNT(DISTINCT customer_key) AS total_customers,
    SUM(quantity) AS total_quantity 
FROM gold.fact_sales
WHERE order_date IS NOT NULL
GROUP BY DATETRUNC(year, order_date)
ORDER BY DATETRUNC(year, order_date)


-- Query 4: Monthly Sales Summary using DATETRUNC
-- Alternative version of Query 2 using DATETRUNC function for month-level truncation
-- Returns the first day of each month as the grouping key
SELECT
    DATETRUNC(month, order_date) AS order_date,
    SUM(sales_amount) AS total_sales,
    COUNT(DISTINCT customer_key) AS total_customers,
    SUM(quantity) AS total_quantity 
FROM gold.fact_sales
WHERE order_date IS NOT NULL
GROUP BY DATETRUNC(month, order_date)
ORDER BY DATETRUNC(month, order_date)
